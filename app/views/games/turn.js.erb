<%= render :partial => 'show_messages' %>

$('.turn_menu').html('<%= escape_javascript render :partial => 'turn_menu' %>');

<%= @extra_js if @extra_js %>

<%#enemies movements take place %>
<% times = [] %>
<% if @paths and @paths.any? %>
  <% @paths.each do |movement| %>
    <% movement.each do |character, path|%>
      <% if path %>

        <% path.each_with_index do |coord,index| %>
          setTimeout(
            function(){
              // debugging line
              //show_message("<%= coord.inspect %>");
              move("#<%= character %>",<%= coord.inspect %>);
            },
            <% time = index * 150 %>
            <% times << time %>
            <%=time%>
          );
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>

<% @game.current_level.characters.each do |character| %>
  set_health(<%= character.id%>, <%= character.health_percent %>);
  set_skill(<%= character.id%>, <%= character.skill_percent %>);
<% end %>

setTimeout(function(){<%= @game.current_character.current_turn_js_call%>},<%= times.max || 0 %>);
